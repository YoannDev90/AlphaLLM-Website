function updateActiveNavItem(e){document.querySelectorAll(".legals-nav-item").forEach(t=>{t.classList.remove("active"),t.getAttribute("href")===e&&t.classList.add("active")})}if(document.addEventListener("DOMContentLoaded",function(){const e=document.querySelector(".mobile-menu-btn"),t=document.querySelector(".nav-links");e&&e.addEventListener("click",function(){t.classList.toggle("active");const n=e.querySelector("i"),o=t.classList.contains("active");e.setAttribute("aria-expanded",o),o?(n.className="fas fa-times",e.setAttribute("aria-label","Fermer le menu")):(n.className="fas fa-bars",e.setAttribute("aria-label","Ouvrir le menu"))});const n=document.getElementById("back-to-top");n&&(window.addEventListener("scroll",function(){window.pageYOffset>300?n.classList.add("visible"):n.classList.remove("visible")}),n.addEventListener("click",function(){window.scrollTo({top:0,behavior:"smooth"})}));const o=document.getElementById("current-year");o&&(o.textContent=(new Date).getFullYear());const s=function(){document.querySelectorAll(".slide-in").forEach(e=>{e.getBoundingClientRect().top<window.innerHeight-50&&(e.style.opacity="1")})};s(),window.addEventListener("scroll",s),document.querySelectorAll(".faq-question").forEach(e=>{e.addEventListener("click",()=>{const t=e.classList.contains("active");document.querySelectorAll(".faq-question").forEach(e=>{e.classList.remove("active")}),t||e.classList.add("active")})});const a=document.querySelectorAll(".legals-nav-item");if(a.length>0){updateActiveNavItem(window.location.hash||"#terms"),a.forEach(e=>{e.addEventListener("click",e=>{updateActiveNavItem(e.target.getAttribute("href"))})})}}),"serviceWorker"in navigator){window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(e=>{console.log("[SW] Enregistré avec succès:",e.scope),e.addEventListener("updatefound",()=>{const t=e.installing;t&&t.addEventListener("statechange",()=>{"installed"===t.state&&navigator.serviceWorker.controller&&confirm("Une nouvelle version est disponible. Recharger la page ?")&&(t.postMessage({type:"SKIP_WAITING"}),window.location.reload())})})}).catch(e=>{console.log("[SW] Échec de l'enregistrement:",e)})});class e{constructor(){this.theme=localStorage.getItem("theme")||"dark",this.init()}init(){this.applyTheme(),this.createToggleButton(),this.bindEvents()}applyTheme(){document.documentElement.setAttribute("data-theme",this.theme),localStorage.setItem("theme",this.theme);const e=document.querySelector(".theme-toggle");if(e){const t=e.querySelector("i");t&&(t.className="dark"===this.theme?"fas fa-sun":"fas fa-moon")}}createToggleButton(){if(!document.querySelector(".theme-toggle")){const e=document.createElement("button");e.className="theme-toggle",e.setAttribute("aria-label","Basculer le thème"),e.innerHTML='<i class="fas fa-sun"></i>';const t=document.querySelector("header .container");t&&t.appendChild(e)}}toggleTheme(){this.theme="dark"===this.theme?"light":"dark",this.applyTheme(),document.body.style.transition="background-color 0.3s ease, color 0.3s ease",setTimeout(()=>{document.body.style.transition=""},300)}bindEvents(){document.addEventListener("click",e=>{e.target.closest(".theme-toggle")&&this.toggleTheme()}),document.addEventListener("keydown",e=>{(e.ctrlKey||e.metaKey)&&e.shiftKey&&"D"===e.key&&(e.preventDefault(),this.toggleTheme())})}}new e}let deferredPrompt;"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("/sw.js").then(()=>{}).catch(()=>{})}),window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),deferredPrompt=e});