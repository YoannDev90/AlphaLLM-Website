document.addEventListener("DOMContentLoaded",function(){window.i18n=new class{constructor(){this.currentLanguage="fr",this.translations={},this.supportedLanguages=["fr","en"],this.init()}setCookie(t,e,a=3650){const n=new Date;n.setTime(n.getTime()+24*a*60*60*1e3),document.cookie=`${t}=${e};expires=${n.toUTCString()};path=/;SameSite=Lax`}getCookie(t){const e=t+"=",a=document.cookie.split(";");for(let t=0;t<a.length;t++){let n=a[t];for(;" "===n.charAt(0);)n=n.substring(1,n.length);if(0===n.indexOf(e))return n.substring(e.length,n.length)}return null}deleteCookie(t){document.cookie=`${t}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`}saveLanguageToStorage(t){try{localStorage.setItem("language",t)}catch(t){console.warn("localStorage not available for language:",t)}}getLanguageFromStorage(){try{const t=localStorage.getItem("language");return t&&this.supportedLanguages.includes(t)?t:null}catch(t){return console.warn("localStorage not available for language:",t),null}}async init(){try{if(window.earlyDetectedLanguage&&this.supportedLanguages.includes(window.earlyDetectedLanguage))this.currentLanguage=window.earlyDetectedLanguage;else{const t=this.getLanguageFromStorage();if(t)this.currentLanguage=t;else{const t=this.getCookie("user_language");if(t&&this.supportedLanguages.includes(t))this.currentLanguage=t,this.saveLanguageToStorage(t);else{const t=navigator.language.split("-")[0];this.supportedLanguages.includes(t)?this.currentLanguage=t:this.currentLanguage="fr"}}}this.saveLanguageToStorage(this.currentLanguage),this.setCookie("user_language",this.currentLanguage),document.documentElement.setAttribute("lang",this.currentLanguage),await this.loadTranslations(this.currentLanguage),this.updatePageTranslations(),this.updateCurrentLangDisplay(this.currentLanguage),this.initLanguageSelectors()}catch(t){this.currentLanguage="fr",this.saveLanguageToStorage("fr"),this.setCookie("user_language","fr"),document.documentElement.setAttribute("lang","fr"),await this.loadTranslations("fr"),this.updatePageTranslations(),this.initLanguageSelectors()}}async loadTranslations(t){try{const e="langs/"+t+".json",a=await fetch(e);if(a.ok)this.translations=await a.json();else{const e=await fetch("/langs/"+t+".json");if(!e.ok)throw new Error(`Erreur HTTP: ${a.status}`);this.translations=await e.json()}return!0}catch(e){try{const e=await fetch("../langs/"+t+".json");if(!e.ok)throw new Error(`Erreur HTTP: ${e.status}`);return this.translations=await e.json(),!0}catch(e){return"fr"!==t&&this.loadTranslations("fr")}}}async changeLanguage(t){if(!this.supportedLanguages.includes(t))return!1;try{if(await this.loadTranslations(t)){this.currentLanguage=t,this.saveLanguageToStorage(t),this.setCookie("user_language",t),document.documentElement.setAttribute("lang",t);const e=document.title.replace(/ \([A-Z]{2}\)$/,"");return document.title=e+" ("+t.toUpperCase()+")",this.updatePageTranslations(),this.updateLanguageSelectors(t),!0}return!1}catch(t){return!1}}updatePageTranslations(){document.querySelectorAll("[data-i18n]").forEach((t,e)=>{const a=t.getAttribute("data-i18n");if(a.includes(".")){const e=a.split(".");let n=this.translations;for(const t of e){if(!n||"object"!=typeof n||!(t in n)){n=null;break}n=n[t]}null!==n&&(t.innerHTML=n)}else this.translations[a]&&(t.innerHTML=this.translations[a]);t.getAttributeNames().filter(t=>t.startsWith("data-i18n-attr-")).forEach(e=>{const a=e.replace("data-i18n-attr-",""),n=t.getAttribute(e);this.translations[n]&&t.setAttribute(a,this.translations[n])})})}updateLanguageSelectors(t){document.querySelectorAll(".language-selector").forEach(e=>{"SELECT"===e.tagName&&(e.value=t)});document.querySelectorAll("[data-lang]").forEach(e=>{e.getAttribute("data-lang")===t?e.classList.add("active"):e.classList.remove("active")}),this.updateCurrentLangDisplay(t)}updateCurrentLangDisplay(t){const e=document.querySelector(".current-lang");if(e){const a={fr:"Français",en:"English",de:"Deutsch",es:"Español",pt:"Português",nl:"Nederlands",it:"Italiano"};e.textContent=a[t]||a.fr}}initLanguageSelectors(){document.querySelectorAll(".language-selector").forEach((t,e)=>{if("SELECT"===t.tagName)t.value=this.currentLanguage,t.addEventListener("change",t=>{const e=t.target.value;this.changeLanguage(e)});else if(t.hasAttribute("data-lang")){const e=t.getAttribute("data-lang");e===this.currentLanguage?t.classList.add("active"):t.classList.remove("active"),t.addEventListener("click",t=>{t.preventDefault(),this.changeLanguage(e)})}}),this.initLanguageDropdown();document.querySelectorAll("[data-lang]:not(.language-selector)").forEach((t,e)=>{const a=t.getAttribute("data-lang");a===this.currentLanguage?t.classList.add("active"):t.classList.remove("active"),t.addEventListener("click",()=>{this.changeLanguage(a)})})}initLanguageDropdown(){const t=document.querySelector(".language-dropdown .dropdown-toggle"),e=document.querySelector(".language-dropdown .dropdown-menu");if(t&&e){t.addEventListener("click",t=>{t.preventDefault(),t.stopPropagation(),e.classList.toggle("show")}),document.addEventListener("click",a=>{t.contains(a.target)||e.contains(a.target)||e.classList.remove("show")});e.querySelectorAll(".lang-btn").forEach(t=>{t.addEventListener("click",a=>{a.preventDefault(),a.stopPropagation();const n=t.getAttribute("data-lang");this.changeLanguage(n),e.classList.remove("show")})})}}translate(t,e=""){if(t.includes(".")){const a=t.split(".");let n=this.translations;for(const t of a){if(!n||"object"!=typeof n||!(t in n))return e;n=n[t]}return n||e}return this.translations[t]||e}}});